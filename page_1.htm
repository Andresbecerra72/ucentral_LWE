<HTML xmlns="http://www.w3.org/1999/xhtml">

<HEAD>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="" />
    <meta name="author" content="Matthias Edler-Golla, wachenfeld-golla.de" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta http-equiv="pragram" content="no-cache" />
    <meta http-equiv="cache-control" content="no-cache, must-revalidate" />
    <meta http-equiv="expires" content="0" />


    <style type="text/css">
        body {
            // background-image: url(img/default.jpg); 
            background: gray;
            background-size: 100%;
            -moz-user-select: none;
            /*ff*/
            -webkit-user-select: none;
            /*webkit*/
            -ms-user-select: none;
            /*IE10*/
            -khtml-user-select: none;
            /*old*/
            user-select: none;
        }
        
        #wrap {
            position: relative;
            margin: auto;
        }
        
        #main {
            position: relative;
            //margin: auto;
            padding: 0;
            top: 0;
            left: 0;
            background-color: white;
            //border:1px solid red;
        }
        
        .textCenter {
            //MARGIN-LEFT: auto;
            vertical-align: middle;
            text-align: center;
            //word-wrap:break-word;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }
    </style>
    <link href="js/jqueryui/jqueryui.css" rel="stylesheet" type="text/css" />
    <link href="css/nav.css" rel="stylesheet" type="text/css" />
    <!-- this script helps older IE versions to understand html5 -->
    <!--[if lt IE 9 ]>
            <script src="js/html5.js"></script>
        <![endif]-->
    <script type="text/javascript" src="/js/utility.js?rdm=162163574"></script>
    <script type="text/javascript" src="/js/storage.js?rdm=162163574"></script>
    <script type="text/javascript" src="/js/bigint.js?rdm=162163574"></script>
    <script type="text/javascript" src="/js/encrypt.js?rdm=162163574"></script>
    <script type="text/javascript" src="/js/ajax.js?rdm=162163574"></script>
    <script type="text/javascript" src="/js/login.js?rdm=162163574"></script>
    <script type="text/javascript" src="/js/pagecommon.js?rdm=162163574"></script>
    <script type="text/javascript" src="/js/binding.js?rdm=162163574"></script>
    <script type="text/javascript" src="js/jquery.js?rdm=162163574"></script>
    <script type="text/javascript" src="js/jqueryui/jqueryui.js?rdm=162163574"></script>
    <script type="text/javascript" src="js/map.js?rdm=162163574"></script>
    <script type="text/javascript" src="js/echart.js?rdm=162163574"></script>
    <script type="text/javascript" src="js/render.js?rdm=162163574"></script>


</HEAD>

<BODY onload="loadPage()">
    <div style="position: fixed;top: 0;left: 0;width: 100%;height: 100%;z-index: 1000; background-color:gray;opacity: 0.98;" id="loadingDiv">
        <p style="position: relative;text-align: center;color:white;top: 45%;" class="blink">LOADING...</p>
    </div>
    <DIV id="wrap">
        <div id="main" onclick="renderJs.hideMenu()" prefix="Siemens" style="width: 1900px; height: 1060px; background-image: url(file:///C:/Users/ANDRES/Documents/ABSOFTWARE/UniversidadCentral/Proyectos%20PLCs/LWE%20caldera/img/E04A0345.png); background-size: 1900px 1060px; margin: 0px; padding: 0px; top: 0px; left: 0px; background-position: 0px 0px; background-repeat: no-repeat no-repeat;"
            bg_image="img/E04A0345.png">



            <div class="TextComponent" comp_type="TextComponent" style="overflow: hidden; line-height: 100%; position: absolute; left: 524px; top: 115px; width: 501px; height: 41px; background-size: 501px 42px; transform: rotate(0deg); font-style: normal; font-family: Arial; font-size: 36px; color: rgb(204, 204, 204); z-index: 4; font-weight: bold; background-repeat: no-repeat no-repeat;"
                id="4ed890abb3562f42b424" degree="0" text_align="center">

                <p style="display: table-cell; vertical-align: middle; text-align: center; width: 501px; height: 41px;">Test Page</p>

            </div>



            <div class="TextComponent" comp_type="TextComponent" style="overflow: hidden; line-height: 100%; position: absolute; left: 648px; top: 243px; width: 252px; height: 41px; background-size: 252px 42px; transform: rotate(0deg); font-style: normal; font-family: Arial; font-size: 14px; color: rgb(204, 204, 204); z-index: 3; background-repeat: no-repeat no-repeat;"
                id="4fbfa049f1238392898c" degree="0" text_align="center">
                <p style="display: table-cell; vertical-align: middle; text-align: center; width: 252px; height: 41px;">@ 2021 abSoftWare</p>
            </div>


            <!-- **** script ***  -->

            <script>
                function storeIdent() {

                    localStorage.setItem('I1', '');
                    localStorage.setItem('I1', '');
                    localStorage.setItem('I1', '');
                    localStorage.setItem('I1', '');
                    localStorage.setItem('I1', '');

                }



                function observer() {

                    const MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;

                    var allElements = document.querySelectorAll('*');
                    for (var i = 0; i < allElements.length; i++) {
                        if (allElements[i].hasAttribute("class")) {
                            console.log(allElements[i].className);
                            if (allElements[i].className.includes("server_binding")) {
                                console.log("I see the class"); // TODO ***
                            }
                        }
                    }

                    // target
                    const list = document.getElementById("49d191ffca718de55e5c");
                    // options
                    const config = {
                        attributes: true,
                        childList: false,
                        characterData: false,
                        subtree: false,
                    };


                    // instance
                    const observer = new MutationObserver(function(mutations) {
                        // console.log(`mutations =`, mutations); // MutationRecord
                        mutations.forEach(function(mutation) {
                            // console.log("mutation =", mutation);
                            if (mutation.type === "characterData") {
                                // console.log("characterData");
                            }
                            if (mutation.type === "childList") {
                                // console.log("childList");
                            }
                            if (mutation.type === "attributes") {
                                console.log("mutation =", mutation);
                                console.log("mutation.target =", mutation.target);
                                console.log("mutation.target.value =", mutation.target.value);
                                console.log(`The \`${mutation.attributeName}\` attribute was modified.`);

                                localStorage.setItem('value', String(mutation.target.value)); // TODO ***

                            }
                        });
                    });


                    // const observer = new MutationObserver(mutation => {
                    //     console.log('DOM mutation detected');
                    // });

                    observer.observe(list, config);

                }


                // envia los datos al DB
                function post_data(id) {



                    console.log("ID: ", id);

                    var oRequest = new DBRequest(document.getElementById(id));
                    console.log("AQUI oRequest: ", oRequest);
                    console.log("AQUI oRequest.m_oSrcElement: ", oRequest.m_oSrcElement);
                    console.log("AQUI oRequest.m_oSrcElement.value: ", oRequest.m_oSrcElement.value);

                    const params = {
                        name: id,
                        count: 1,
                        message: "FALLA BOMBA"
                    }


                    var http = new XMLHttpRequest();
                    http.open("POST", "http://localhost/ucentral-API/fails");
                    http.setRequestHeader('Content-type', 'application/json');
                    http.setRequestHeader('Authorization', 'Basic NzBlYzZmYTRkNmVlMmEyZWFlZDRhODA5NmFiYTJlYWE6M2NlODBmZDA3ZGI2ZTRjYzcyZDE3NDQ5YWIxMzllYjU=');
                    http.send(JSON.stringify(params));
                    // http.onload = function() {                        
                    //     alert(http.responseText)
                    // }

                    // setTimeout(post_data("49d191ffca718de55e5c"), 30000);

                }

                // post_data("49d191ffca718de55e5c");







                window.onload = function() {






                    post_data("49d191ffca718de55e5c");
                    observer();
                };
            </script>


        </div>
    </DIV>
    <div id='timeout_dlg' style='display: none'>Please check the network connection!</div>






</BODY>

</HTML>